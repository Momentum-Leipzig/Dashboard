---
title: "Personality"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: true
    toc_depth: 1
    include:
      after_body: footer/_footer_Richard.txt
bibliography: footer/references.bib
csl: footer/apa.csl
---
<style type="text/css">
  a {
    color: #3182bd;
    background-color: transparent;
    text-decoration: none;
  }
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE,warning=FALSE, cache=TRUE)
library(ggplot2)
library(plyr)
library(dplyr)
library(plotly)
library(tidyr)
library(hrbrthemes)
library(gganimate)
library(inauguration)


options(scipen = 999)
data_pers = read.csv("data/data_Personality.csv")

months_PTG = c("May '20", "June '20", "July '20", "August '20", "September '20", "October '20", "November '20", "December '20",
               "January '21", "February '21", "March '21", "April '21", "May '21")

months_lifesat = c("December '19",
  "March '20","April '20","May '20", "June '20", "July '20", "August '20", "September '20", "October '20", "November '20", "December '20",
               "January '21", "February '21", "March '21", "April '21", "May '21")

months_Pers = c("December '19", "June '20", "March '21")
months_CSE_Proact = c("December '19", "June '20", "April '21")
months_Mind = c("December '19", "March '20", "June '20")

# Colours
Extra_col = inauguration("inauguration_2021_bernie")[1]
Agree_col = inauguration("inauguration_2021_bernie")[2]
Open_col = inauguration("inauguration_2021_bernie")[3]
Consc_col = inauguration("inauguration_2021_bernie")[4]
Emot_col = inauguration("inauguration_2021_bernie")[5]
Rest_col = "#3182bd"

font_colour = theme(text = element_text(colour = "#3e3f3a")) 
# Standard font colour of the text as indicated by the theme. Add to any gg plot to make all text in it the same colour as the "normal" body-text. MAY OVERRIDE POTENTIAL INTENDED FONTCOLOURS IN INDIVIDUAL PLOTS 

# Get the colours of the brewer-colorscale from https://colorbrewer2.org/#type=sequential&scheme=Blues&n=5

```


# Introduction  
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim.

# Personality in December 

## Big Five {.tabset .tabset-fade}

### Extraversion {-}

```{r density Extrav , include=TRUE, fig.height=4}

density_EX_T1 = ggplot(data_pers, aes(T1_extraversion))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col=Extra_col, fill = Extra_col, alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_extraversion, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Extraversion Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_EX_T1
```

Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo.  

### Agreeableness {-}
```{r density Agr , include=TRUE, fig.height=4}

density_AG_T1 = ggplot(data_pers, aes(T1_agreeableness))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col=Agree_col, fill = Agree_col, alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_agreeableness, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Agreeableness Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_AG_T1
```

### Openness {-}

```{r density Open , include=TRUE, fig.height=4}

density_OP_T1 = ggplot(data_pers, aes(T1_openness))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col=Open_col, fill = Open_col, alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_openness, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Openness Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_OP_T1
```

### Conscientiousness {-}

```{r density Consc , include=TRUE, fig.height=4}

density_CO_T1 = ggplot(data_pers, aes(T1_conscientiousness))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col=Consc_col, fill =Consc_col, alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_conscientiousness, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Conscientiousness Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_CO_T1
```

### Emotional Stability {-}

```{r density EmStab , include=TRUE, fig.height=4}

density_ES_T1 = ggplot(data_pers, aes(T1_emostab))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col=Emot_col, fill = Emot_col, alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_emostab, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Emotional Stability Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_ES_T1
```


## Mindfulness - Trait {.tabset .tabset-fade}

### Awareness {-}

```{r density Aware , include=TRUE, fig.height=4}

density_MAw_T1 = ggplot(data_pers, aes(T1_mindTr_aw))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col="#3182bd", fill = "#6baed6", alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_mindTr_aw, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Mindfulness: Awareness Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_MAw_T1
```

### Acceptance {-}

```{r density Accept , include=TRUE, fig.height=4}

density_MAcc_T1 = ggplot(data_pers, aes(T1_mindTr_acc))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col="#3182bd", fill = "#6baed6", alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_mindTr_acc, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Mindfulness: Acceptance Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_MAcc_T1
```

  
---  

## Proactive Personality
```{r density ProPers , include=TRUE, fig.height=4}

density_proact_T1 = ggplot(data_pers, aes(T1_proact_pers))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col="#3182bd", fill = "#6baed6", alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_proact_pers, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Proactive Personality Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  # Indicating the scale size and labels; seq to be read like: "Make a sequence from 0 to 100, going in steps of 10
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_proact_T1
```

  
---  
  
## Core Self Evaluations
```{r density CSE , include=TRUE, fig.height=4}

density_CSE_T1 = ggplot(data_pers, aes(T1_CSE))+
  theme_classic()+
  geom_histogram(binwidth=0.5,col="#3182bd", fill = "#6baed6", alpha = .4)+
  geom_vline(aes(xintercept=mean(T1_CSE, na.rm=T)), linetype="dashed", size= 0.5)+ #Line representing the mean
  labs(x="Core Self Evaluations Score", y = "Amount of participants")+
  scale_x_continuous(breaks = seq(0,7,0.5), labels = seq(0,7,0.5)) +
  scale_y_continuous(breaks=seq(0, 400, 50))+
  theme(axis.text=element_text(size=12), axis.title = element_text(size = 14)) +
  font_colour

density_CSE_T1
```

  
---  
  

# Change over Time
  
  
## Big Five {.tabset .tabset-fade} 

### Extraversion {-}

```{r change extr, include=TRUE}
big5_long =   reshape(
  
  select(data_pers, ID, 
         ends_with("extraversion"),
         ends_with("agreeableness"),
         ends_with("conscientiousness"),
         ends_with("openness"),
         ends_with("emostab")
         ), 
 
  varying = list(grep("extraversion", names(data_pers), value = T), 
                 grep("agreeableness", names(data_pers), value = T),
                 grep("conscientiousness", names(data_pers), value = T),
                 grep("openness", names(data_pers), value = T),
                 grep("emostab", names(data_pers), value = T)
                 ),
  
  v.names = c("Extra", "Aggree","Consc","Open","Emot"),
 
  direction = "long", 
 
  timevar = "month", 

  idvar = "ID" 
)               

big5_long$month = factor(big5_long$month, labels = months_Pers, levels = c(1,2,3))


extra_change = ggplot(big5_long, aes(x=month, y = Extra)) +
  geom_violin(trim = T,col= Extra_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Extra_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Extra_col), col= Extra_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Extra_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col =Extra_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_Pers, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Extraversion")+
  font_colour

extra_change

```

### Agreeableness {-}

```{r change agree, include=TRUE, fig.show='hold'}
agree_change = ggplot(big5_long, aes(x=month, y = Aggree)) +
  geom_violin(trim = T,col= Agree_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Agree_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Agree_col), col= Agree_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Agree_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col = Agree_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_Pers, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Agreableness")+
  font_colour

agree_change
```

### Openness {-}

```{r change open, include=TRUE, fig.show='hold'}
open_change = ggplot(big5_long, aes(x=month, y = Open)) +
  geom_violin(trim = T,col= Open_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Open_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Open_col), col= Open_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Open_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col = Open_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_Pers, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Openness")+
  font_colour

open_change
```


### Conscientiousness {-}

```{r change consc, include=TRUE, fig.show='hold'}
consc_change = ggplot(big5_long, aes(x=month, y = Consc)) +
  geom_violin(trim = T,col= Consc_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Consc_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Consc_col), col= Consc_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Consc_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col = Consc_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_Pers, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Conscientiousness")+
  font_colour

consc_change
```


### Emotional Stability {-}

```{r change emot, include=TRUE, fig.show='hold'}
emot_change = ggplot(big5_long, aes(x=month, y = Emot)) +
  geom_violin(trim = T,col= Emot_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Emot_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Emot_col), col= Emot_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Emot_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col = Emot_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_Pers, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Emotional Stability")+
  font_colour

emot_change
```

## Mindfulness - Trait {.tabset .tabset-fade}

### Awareness {-}
```{r change aware, include=TRUE}
Mind_long =   reshape(

  select(data_pers, ID,
         ends_with("_mind_aware"),
         ends_with("_mind_accept")
         ),

  varying = list(c("T1_mind_aware","T2_mind_aware","T5_mind_aware"),
                 c("T1_mind_accept","T2_mind_accept","T5_mind_accept")
                 ),

  v.names = c("Mind_Aw","Mind_Ac"),

  direction = "long",

  timevar = "month",

  idvar = "ID"
)

Mind_long$month = factor(Mind_long$month, labels = months_Mind)

aware_change = ggplot(Mind_long, aes(x=month, y = Mind_Aw)) +
  geom_violin(trim = T,col= Rest_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Rest_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Rest_col), col= Rest_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Rest_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col =Rest_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_Mind, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Mindfulness: Awareness")+
  font_colour

aware_change
```

### Acceptance {-}
```{r change acc, include=TRUE}

accept_change = ggplot(Mind_long, aes(x=month, y = Mind_Ac)) +
  geom_violin(trim = T,col= Rest_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Rest_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Rest_col), col= Rest_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Rest_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col =Rest_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_Mind, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Mindfulness: Acceptance")+
  font_colour

accept_change
```

## Proactive Personality
```{r change proact, include=TRUE}
CES_Proact_long =   reshape(

  select(data_pers, ID,
         ends_with("proact_pers"),
         ends_with("CSE")
         ),

  varying =  list(grep("CSE", names(data_pers), value = T),
                 grep("proact", names(data_pers), value = T)
                 ),

  v.names = c("CSE","Proact"),

  direction = "long",

  timevar = "month",

  idvar = "ID"
)

CES_Proact_long$month = factor(CES_Proact_long$month, labels = months_CSE_Proact)

proact_change = ggplot(CES_Proact_long, aes(x=month, y = Proact)) +
  geom_violin(trim = T,col= Rest_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Rest_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Rest_col), col= Rest_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Rest_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col =Rest_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_CSE_Proact, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Proactive Personality")+
  font_colour

proact_change
```

## Core Self Evaluations
```{r change CSE, include=TRUE}

CSE_change = ggplot(CES_Proact_long, aes(x=month, y = CSE)) +
  geom_violin(trim = T,col= Rest_col ) +
  geom_jitter(width = 0.1, size = 0.05,col= Rest_col, alpha = 0.3) +
  
  geom_line(aes(group=1, color = Rest_col), col= Rest_col, size = 1, stat = "summary", fun = mean)+
  geom_point(col= Rest_col, size = 3, stat = "summary", fun = mean)+
  geom_errorbar(width=.1,position=position_dodge(0.05), col =Rest_col, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1)) +
  
  coord_cartesian(ylim = c(1,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_CSE_Proact, name ="" )+
  scale_y_continuous(breaks = seq(1,7,1), name = "Core Self Evaluations")+
  font_colour

CSE_change
```

Further Ideas: 
Life Satisfaction depending on Personality traits and mindfulness
PTG over Time



# Life Satisfaction depending on Traits

```{r sat, include = TRUE}
lifesat_long = reshape(
  select(data_pers, 
         ID, 
         T1_extraversion,
         T1_agreeableness,
         T1_conscientiousness,
         T1_openness,
         T1_emostab,
         T1_CSE,
         T1_proact_pers,
         T1_mind_aware,
         T1_mind_accept,
         ends_with("life_sat")
         ),

  varying =  grep("life", names(data_pers), value = T),

  v.names = "Life_Sat",

  direction = "long",

  timevar = "month",

  idvar = "ID"
  
)

lifesat_long$month = factor(lifesat_long$month, labels = months_lifesat)

pers_higlow = data_pers %>% dplyr::summarise_at(
  vars(
    T1_extraversion,
    T1_agreeableness,
    T1_conscientiousness,
    T1_openness,
    T1_emostab,
    T1_CSE,
    T1_proact_pers,
    T1_mind_aware,
    T1_mind_accept
    ), 
  list(high =~ mean(.x, na.rm = T) + sd(.x, na.rm = T), 
       low =~ mean(.x, na.rm = T) - sd(.x, na.rm = T)))

## Making new grouping Variables
lifesat_long =lifesat_long %>% mutate(
    Extraversion = case_when(
      T1_extraversion >= pers_higlow$T1_extraversion_high & !is.na(T1_extraversion) ~ "high",
      T1_extraversion <= pers_higlow$T1_extraversion_low & !is.na(T1_extraversion) ~ "low",
      T1_extraversion < pers_higlow$T1_extraversion_high & T1_extraversion > pers_higlow$T1_extraversion_low & !is.na(T1_extraversion) ~ "average"
    ),
    
    Agreeableness = case_when(
      T1_agreeableness >= pers_higlow$T1_agreeableness_high ~ "high",
      T1_agreeableness <= pers_higlow$T1_agreeableness_low  ~ "low",
      T1_agreeableness < pers_higlow$T1_agreeableness_high & T1_agreeableness > pers_higlow$T1_agreeableness_low ~ "average"
    ),
    
    Openness = case_when(
      T1_openness >= pers_higlow$T1_openness_high ~ "high",
      T1_openness <= pers_higlow$T1_openness_low ~ "low",
      T1_openness < pers_higlow$T1_openness_high & T1_openness > pers_higlow$T1_openness_low ~ "average"
    ),
    
    Conscientiousness = case_when(
      T1_conscientiousness >= pers_higlow$T1_conscientiousness_high ~ "high",
      T1_conscientiousness <= pers_higlow$T1_conscientiousness_low ~ "low",
      T1_conscientiousness < pers_higlow$T1_conscientiousness_high & T1_conscientiousness > pers_higlow$T1_conscientiousness_low ~ "average"
    ),
    
    Stability = case_when(
      T1_emostab >= pers_higlow$T1_emostab_high ~ "high",
      T1_emostab <= pers_higlow$T1_emostab_low ~ "low",
      T1_emostab < pers_higlow$T1_emostab_high & T1_emostab > pers_higlow$T1_emostab_low ~ "average"
    ),
    
    Mind_Aware = case_when(
      T1_mind_aware >= pers_higlow$T1_mind_aware_high ~ "high",
      T1_mind_aware <= pers_higlow$T1_mind_aware_low ~ "low",
      T1_mind_aware < pers_higlow$T1_mind_aware_high & T1_mind_aware > pers_higlow$T1_mind_aware_low ~ "average"
    ),
    
    Mind_Accept = case_when(
      T1_mind_accept >= pers_higlow$T1_mind_accept_high ~ "high",
      T1_mind_accept <= pers_higlow$T1_mind_accept_low ~ "low",
      T1_mind_accept < pers_higlow$T1_mind_accept_high & T1_mind_accept > pers_higlow$T1_mind_accept_low ~ "average"
    ),
    
    CSE = case_when(
      T1_CSE >= pers_higlow$T1_CSE_high ~ "high",
      T1_CSE <= pers_higlow$T1_CSE_low ~ "low",
      T1_CSE < pers_higlow$T1_CSE_high & T1_CSE > pers_higlow$T1_CSE_low ~ "average"
    ),
    
    Proact_Pers = case_when(
      T1_proact_pers >= pers_higlow$T1_proact_pers_high ~ "high",
      T1_proact_pers <= pers_higlow$T1_proact_pers_low ~ "low",
      T1_proact_pers < pers_higlow$T1_proact_pers_high & T1_proact_pers > pers_higlow$T1_proact_pers_low ~ "average"
    ),
    
    
)

lifesat_long[13:21] =  lapply(select(lifesat_long, Extraversion:Proact_Pers),factor, levels =c("low", "average", "high") , labels =c("Low", "Average", "High"))

lifesat_long = lifesat_long[lifesat_long$Life_Sat > 0,]

lifesat = ggplot(lifesat_long, aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = 1),col= "#74c476", size = 1.5, stat = "summary", fun = mean)+
  geom_point(size = 3,col="#74c476", stat = "summary", fun = mean)+
  geom_ribbon(aes(group = 1),fill="#74c476", alpha=0.4, stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1) ) +
  
  scale_color_manual(values = "#74c476")+
  
  coord_cartesian(ylim = c(3,7))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(3,7,1), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  labs(caption = "Note: Ribbon represents one SD above and below the mean.")+
  font_colour

lifesat
```


## Big Five {.tabset .tabset-fade} 

### Extraversion {-}

```{r sat extr, include=TRUE}
Extra_col_3 = c("#8478ca","#5445b1","#3a307a")

lifesat_extra = ggplot(lifesat_long[is.na(lifesat_long$Extraversion)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Extraversion, color = Extraversion), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Extraversion), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Extra_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.")+
  font_colour

lifesat_extra

```

### Agreeableness {-}

```{r sat agree, include=TRUE}
Agree_col_3 = c("#ac937e","#876d57","#584739")

lifesat_agree = ggplot(lifesat_long[is.na(lifesat_long$Agreeableness)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Agreeableness, color = Agreeableness), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Agreeableness), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Agree_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.")+
  font_colour

lifesat_agree
```

### Openness {-}

```{r sat open, include=TRUE}
Open_col_3 = c("#a4bfca","#749dae","#4f7687")

lifesat_open = ggplot(lifesat_long[is.na(lifesat_long$Openness)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Openness, color = Openness), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Openness), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Open_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.")+
  font_colour

lifesat_open
```


### Conscientiousness {-}

```{r sat consc, include=TRUE}
Consc_col_3 = c("#fae5c9","#f3c483","#eca33d")

lifesat_consc = ggplot(lifesat_long[is.na(lifesat_long$Conscientiousness)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Conscientiousness, color = Conscientiousness), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Conscientiousness), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Consc_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.")+
  font_colour

lifesat_consc
```


### Emotional Stability {-}

```{r sat emot, include=TRUE}
Emot_col_3 = c("#982b54","#5c1a33","#200912")

lifesat_emot = ggplot(lifesat_long[is.na(lifesat_long$Stability)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Stability, color = Stability), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Stability), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Emot_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.", color = "Emotional Stability")+
  font_colour

lifesat_emot
```

## Mindfulness - Trait {.tabset .tabset-fade}

### Awareness {-}
```{r sat aware, include=TRUE}
Rest_col_3 = c("#64a6d7","#3182bd","#215880")

lifesat_aware = ggplot(lifesat_long[is.na(lifesat_long$Mind_Aware)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Mind_Aware, color = Mind_Aware), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Mind_Aware), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Rest_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.", color = "Mindfulness - Awareness")+
  font_colour

lifesat_aware
```

### Acceptance {-}
```{r sat acc, include=TRUE}
lifesat_acc = ggplot(lifesat_long[is.na(lifesat_long$Mind_Accept)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Mind_Accept, color = Mind_Accept), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Mind_Accept), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Rest_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.", color = "Mindfulness - Acceptance")+
  font_colour

lifesat_acc

```

## Proactive Personality
```{r sat proact, include=TRUE}
lifesat_proact = ggplot(lifesat_long[is.na(lifesat_long$Proact_Pers)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = Proact_Pers, color = Proact_Pers), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = Proact_Pers), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Rest_col_3)+
  
  coord_cartesian(ylim = c(4,6))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(4,6,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.", color = "Proactive Personality")+
  font_colour

lifesat_proact
```

## Core Self Evaluations
```{r sat CSE, include=TRUE}
lifesat_CSE = ggplot(lifesat_long[is.na(lifesat_long$CSE)==F,], aes(x=month, y = Life_Sat)) +
  geom_line(aes(group = CSE, color = CSE), size = 1, stat = "summary", fun = mean)+
  geom_point(aes(color = CSE), size = 3, stat = "summary", fun = mean)+
  scale_color_manual(values = Rest_col_3)+
  
  coord_cartesian(ylim = c(3.5,6.5))+
  theme_minimal()+
  scale_x_discrete(limits = months_lifesat, name ="" )+
  scale_y_continuous(breaks = seq(3.5,6.5,0.5), name = "Life Satisfaction")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1),legend.position = "top")+
  labs(caption = "Note: Borders for average were defined as one SD above and below the mean.", color = "Core Self Evaluations")+
  font_colour

lifesat_CSE

```


# Header 1 {.tabset .tabset-fade}

## Plot {-}

```{r one wide figure, include = TRUE, out.width='100%', fig.height=3.5}


```

## More Information {-} 

```{r one wide figure 2, include = TRUE, out.width='100%', fig.height=3.5}


```

# {.unnumbered .toc-ignore}

## Header 2

# Header 1
